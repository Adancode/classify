console.log("loading " + module.id);

var mysql = require("mysql");
var cody = require("cody");

function CommentController(context) {
    var self = this;
    console.log("CommentController.constructor -> page(" + context.page.itemId + ") = " + context.page.title + ", request = " + context.request);
    self.CommentView = "Commentablepage.ejs";
    // init inherited controller
    cody.Controller.call(self, context);
}
CommentController.prototype = Object.create( cody.Controller.prototype);
module.exports = CommentController;


CommentController.prototype.doRequest = function(finish) {
    var self = this;
    if (self.isRequest("")) {
        // ordinary request
        // do stuff
        finish(self.CommentView);
    } else if (self.isRequest("SUBMIT")) {
        // comment is submitted
        var user = self.getParam('uName');
        var comment = self.getParam('comment');
        console.log(user + " said: " + comment);
        // do stuff
        finish(self.CommentView);
    } else {
    	finish(self.CommentView);
    }
}

